
# 操作指南（Docker 启动）

下面给出使用 Docker 启动后端 API 的步骤（默认当前路径为仓库根目录）。

## 前置准备
- 安装 Docker 与 Docker Compose（Docker Desktop 自带 Compose）。
- 确认 8000 端口可用（后端默认映射 8000）。

## 1. 准备后端环境变量
```bash
cd backend
cp .env.example .env
# 打开 .env，填入硅基流动的 OPENAI_API_KEY（留空则走离线兜底）
# 可按需修改 MODEL_NAME/LLM_BASE_URL/EMBEDDING_MODEL 等参数
cd ..
```

## 2. 构建并启动后端容器
```bash
# 在仓库根目录
docker compose up --build
```
- 首次会构建镜像，日志出现 `Uvicorn running on http://0.0.0.0:8000` 表示成功。
- 数据目录 `backend/data/` 已挂载到容器内，持久化 FAISS 索引。

## 3. 验证后端
```bash
# 健康检查
curl http://localhost:8000/health
# 上传 PPTX 测试
curl -F "file=@your.pptx" http://localhost:8000/ppt/process
```

## 4. 前端（本地运行）
当前 docker-compose 仅包含后端，前端需在本机跑 Next.js：
```bash
cd frontend
npm install
npm run dev
# 浏览器打开 http://localhost:3000
# 若后端不在本机，可在 frontend/.env 设置 NEXT_PUBLIC_API_BASE（默认 http://localhost:8000）
```

## 常见问题
- 无模型密钥：`.env` 留空时返回离线兜底，建议填入有效的硅基流动 Key。
- 重建索引：删除 `backend/data/faiss.index` 后重新调用接口会自动重建。
